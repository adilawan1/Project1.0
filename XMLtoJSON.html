<!DOCTYPE html>
<html>
  <body>
    <h1>XML to JSON Converter</h1>
    <h4>JSON:</h4>
    <textarea
      id="JSON"
      rows="5"
      style="width: 45%; font-size: larger"
    ></textarea>
    <h4>XML:</h4>
    <textarea
      id="XML"
      rows="5"
      style="width: 45%; font-size: larger"
    ></textarea>
    <div>
      <button onclick="fileHandling()">Upload a File</button>
      <button onclick="XML2JS()">Convert to JSON</button>
    </div>
    <div><input id="url" placeholder="URL"></input></div>
    <button onclick='fetch(document.getElementById("url").value)
    .then(res => res.text())
    .then(text => document.getElementById("XML").innerHTML =text)'>URL</button>
    <button onclick="location.reload()">RESET</button>
    <!-- XML TO JSON Function -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/x2js/1.2.0/xml2json.min.js"
      integrity="sha512-HX+/SvM7094YZEKOCtG9EyjRYvK8dKlFhdYAnVCGNxMkA59BZNSZTZrqdDlLXp0O6/NjDb1uKnmutUeuzHb3iQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script>
      function fileHandling() {
        var input = document.createElement("input");
        input.type = "file";
        input.onchange = (e) => {
          // getting a hold of the file reference
          var file = e.target.files[0];

          // setting up the reader
          var reader = new FileReader();
          reader.readAsText(file, "UTF-8"); // this is reading as data url

          // here we tell the reader what to do when it's done reading...
          reader.onload = (readerEvent) => {
            var content = readerEvent.target.result; // this is the content!
            document.querySelector("#XML").innerText = content;
          };
        };
        input.click();
      }

      var x2js = new X2JS();
      function XML2JS() {
        var xmlText = document.getElementById("XML").value;
        xmlText = xmlText.replace("&", "&amp;");
        var jsonObj = x2js.xml_str2json(xmlText);
        document.getElementById("JSON").innerHTML = JSON.stringify(
          jsonObj,
          null,
          2
        );
      }
    </script>
  </body>
</html>
