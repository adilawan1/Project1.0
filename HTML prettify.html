
  <div>
    <h1>HTML Prettifier</h1>
    <form>
      <label for="input">Enter HTML:</label>
      <br>
      <textarea id="input"></textarea>
      <br>
      <button type="button" onclick="prettifyHTML()">Prettify</button>
      <br>
      <label for="output">Prettified HTML:</label>
      <br>
      <textarea id="output"></textarea>
    </form>

    <button type="submit" id="download-btn">Download HTML</button>

    <script>
      const downloadButton = document.getElementById('download-btn');
      const input = document.getElementById('input');
      const output = document.getElementById('output');

      let htmlString;

      function prettifyHTML() {
        try {
          const ht = input.value;
          const tabSize = 2;
          htmlString = '';
          const tabChar = ' ';
          let indentLevel = 0;
          let buffer = '';

          // Split the input HTML string into individual tags
          const tags = ht.split(/(<\/?\w+(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'))*)*\s*\/?>)/);

          for (let i = 0; i < tags.length; i++) {
            const tag = tags[i];

            if (tag.startsWith('</')) {
              // Decrease the indent level for closing tags
              indentLevel--;
            }

            // Add the current tag to the output with appropriate indentation
            buffer += `${tabChar.repeat(tabSize * indentLevel)}${tag}`;

            if (tag.startsWith('<') && !tag.endsWith('/>')) {
              // Increase the indent level for opening tags
              indentLevel++;
              buffer += '\n';
            }

            // If the buffer is too big, append it to the output and clear the buffer
            if (buffer.length > 10000) {
              htmlString += buffer;
              buffer = '';
            }
          }

          // Append the remaining buffer to the output
          htmlString += buffer;
          output.value = htmlString;
        } catch (error) {
          console.error(error);
          alert('There was an error with your input.');
        }
      }

      downloadButton.addEventListener('click', () => {
        if (htmlString != null) {
          const filename = 'output.html';
          const link = document.createElement('a');
          link.setAttribute('href', `data:text/plain;charset=utf-8,${encodeURIComponent(htmlString)}`);
          link.setAttribute('download', filename);
          link.click();
        } else {
          alert('Please convert your HTML code before downloading.');
        }
      });
    </script>
  </div>
